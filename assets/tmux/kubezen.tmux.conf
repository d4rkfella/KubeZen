# KubeZen tmux Configuration

# --- Basic Settings ---
set-option -g prefix C-a          # Set a more ergonomic prefix
unbind-key C-b                   # Unbind the default prefix
bind-key C-a send-prefix         # Allow sending C-a to applications

set-option -s escape-time 10

set-option -g history-limit 10000 # Increase scrollback buffer size
set-option -g base-index 1        # Start window numbering at 1
set-window-option -g pane-base-index 1 # Start pane numbering at 1
set-option -g renumber-windows on # Renumber windows when one is closed

# --- Mouse Support ---
# This is crucial for KubeZen's status bar interactions and the swipe plugin.
# It will be further configured by TmuxUIManager at runtime if needed.
set-option -g mouse on
set-option -g display-time 5000 # Display messages for 5 seconds (5000ms)

# --- Status Bar ---
# KubeZen's TmuxUIManager will dynamically set the status bar for clickable windows.
# However, some basic styling can be set here.
set-option -g status-position bottom
set-option -g status-justify left
set-option -g status-style "fg=colour247,bg=colour236" # Light grey on dark grey

set-option -g status-left-length 90
set-option -g status-right-length 90

set-option -g status-left "#[fg=colour232,bg=colour154,bold] #S #[fg=colour154,bg=colour236,nobold]" # Session name
set-option -g status-right "#[fg=colour247,bg=colour236]%Y-%m-%d  %H:%M #[fg=colour154,bg=colour236,nobold]#[fg=colour232,bg=colour154,bold] #H " # Date, Time, Hostname

set-window-option -g window-status-current-style "fg=colour232,bg=colour51,bold"
set-window-option -g window-status-current-format " #I #W#{?window_flags,#{window_flags}, } " # With flags

set-window-option -g window-status-style "fg=colour102,bg=colour236"
set-window-option -g window-status-format " #I #W#{?window_flags,#{window_flags}, } "

set-window-option -g window-status-bell-style "fg=colour232,bg=colour160,bold" # Red bg for bell

# Check if the environment variable is set and the script exists
if-shell '[ -n "$KUBEZEN_MOUSE_SWIPE_PLUGIN_ABS_PATH" ] && [ -f "$KUBEZEN_MOUSE_SWIPE_PLUGIN_ABS_PATH" ]' {
  run-shell "$KUBEZEN_MOUSE_SWIPE_PLUGIN_ABS_PATH"
}

# --- Visuals ---
set-option -g default-terminal "tmux-256color"
set-option -ga terminal-overrides ",*:Tc" # True color support for all terminals
set-option -ga terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # Enable undercurl
set-option -ga terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # Enable undercurl colors

# Pane borders
set-option -g pane-border-style "fg=colour238"  # Dark grey
set-option -g pane-active-border-style "fg=colour51" # Blue

# Message styling
set-option -g message-style "fg=colour232,bg=colour154,bold" # Black on Yellow

# --- Key Bindings for easier navigation (optional, but good examples) ---
# Split panes using | and -
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Switch panes using Alt-arrow without prefix
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Resize panes
bind -r H resize-pane -L 2
bind -r J resize-pane -D 2
bind -r K resize-pane -U 2
bind -r L resize-pane -R 2

# Kill pane/window without confirmation
bind x kill-pane
bind X kill-window